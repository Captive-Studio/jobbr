Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.0ms)[0m  rollback transaction
Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.0ms)[0m  rollback transaction
Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5352ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3090ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2279ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118c4ad5b1eb1f56d000001", "delayed"=>true, "_type"=>"Jobbr::TestDelayedJob", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1009ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.0939ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0961ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (279.2959ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.1140ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3290ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.4730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4048ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1369ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0851ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3378ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0870ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4079ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1040ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0811ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3350ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0811ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4282ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d000005", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1011ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000005"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.5832ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.1330ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3748ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.4160ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3121ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118c4ad5b1eb1f56d000006", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1552ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1552ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3030ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0920ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3083ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3519ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3252ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.0892ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2820ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0830ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3321ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1209ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2580ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.1042ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5181ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d00000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1202ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.5839ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.2172ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.4127ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4208ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d00000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.0849ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2301ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0813ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2861ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118c4ad5b1eb1f56d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1950ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2191ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2213ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d00000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.0820ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3130ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000c"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0811ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2780ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d00000d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2091ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118c4ad5b1eb1f56d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2291ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.1693ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3998ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d00000e", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.0801ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2789ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000e"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0789ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2911ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2871ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2849ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3178ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d00000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1159ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2649ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0811ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2971ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3059ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3059ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4382ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d000010", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1180ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2511ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000010"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.1850ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4139ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4380ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2880ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::LoggingJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3619ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118c4ad5b1eb1f56d000011", "scheduled"=>true, "_type"=>"Jobbr::LoggingJob", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.1149ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4ad5b1eb1f56d000012", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:09 UTC, "job_id"=>"5118c4ad5b1eb1f56d000011", "updated_at"=>2013-02-11 10:15:09 UTC, "created_at"=>2013-02-11 10:15:09 UTC}] flags=[] (0.0732ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000011"}} (0.2728ms)
foo
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000012"} update={"$push"=>{"log_messages"=>{"_id"=>"5118c4ad5b1eb1f56d000013", "kind"=>:debug, "message"=>"foo", "date"=>2013-02-11 10:15:09 UTC}}} flags=[] (0.1233ms)
bar
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000012"} update={"$push"=>{"log_messages"=>{"_id"=>"5118c4ad5b1eb1f56d000014", "kind"=>:error, "message"=>"bar", "date"=>2013-02-11 10:15:09 UTC}}} flags=[] (0.1001ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000012"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:09 UTC, "updated_at"=>2013-02-11 10:15:09 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (21.8022ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000011"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4129ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000011"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3679ms)
  [1m[35m (0.1ms)[0m  rollback transaction
Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.6890ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2508ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2961ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f423000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.1028ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0889ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.2742ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2880ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3238ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3610ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f423000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0830ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.2310ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0751ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3169ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f423000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3426ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0811ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4029ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f423000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0641ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3810ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0708ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2110ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3991ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4160ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f423000005", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0839ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2863ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0758ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2460ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3150ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3462ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f423000006", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0768ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3209ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3211ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f423000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0710ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3099ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0720ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4861ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f423000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2780ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2818ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3762ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f423000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0751ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3121ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3467ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3619ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f42300000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.1082ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2828ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f42300000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0792ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3669ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3769ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f42300000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0772ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3200ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f42300000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3502ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5710ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f42300000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0851ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3200ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f42300000c"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3481ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4611ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f42300000d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0770ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2470ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f42300000d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0808ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3779ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::LoggingJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3889ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c4bd5b1eb1f42300000e", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:15:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000011", "updated_at"=>2013-02-11 10:15:25 UTC, "created_at"=>2013-02-11 10:15:25 UTC}] flags=[] (0.0901ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000011"}} (0.3102ms)
foo
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f42300000e"} update={"$push"=>{"log_messages"=>{"_id"=>"5118c4bd5b1eb1f42300000f", "kind"=>:debug, "message"=>"foo", "date"=>2013-02-11 10:15:25 UTC}}} flags=[] (0.1082ms)
bar
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f42300000e"} update={"$push"=>{"log_messages"=>{"_id"=>"5118c4bd5b1eb1f423000010", "kind"=>:error, "message"=>"bar", "date"=>2013-02-11 10:15:25 UTC}}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f42300000e"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:15:25 UTC, "updated_at"=>2013-02-11 10:15:25 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4239ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000011"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.6871ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000011"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5760ms)
  [1m[35m (0.1ms)[0m  rollback transaction
Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.6020ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3500ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5235b1eb188b6000001", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:17:07 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:17:07 UTC, "created_at"=>2013-02-11 10:17:07 UTC}] flags=[] (0.0980ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2892ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5235b1eb188b6000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:17:07 UTC, "updated_at"=>2013-02-11 10:17:07 UTC}} flags=[] (0.1452ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4282ms)
  [1m[35m (0.1ms)[0m  rollback transaction
Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5860ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2983ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5375b1eb17992000001", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:17:27 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:17:27 UTC, "created_at"=>2013-02-11 10:17:27 UTC}] flags=[] (0.0982ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3941ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5375b1eb17992000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:17:27 UTC, "updated_at"=>2013-02-11 10:17:27 UTC}} flags=[] (0.0908ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.6700ms)
  [1m[35m (0.1ms)[0m  rollback transaction
Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5379ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3238ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5da5b1eb1397d000001", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:20:10 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:20:10 UTC, "created_at"=>2013-02-11 10:20:10 UTC}] flags=[] (0.1040ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.5810ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5da5b1eb1397d000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:20:10 UTC, "updated_at"=>2013-02-11 10:20:10 UTC}} flags=[] (0.1411ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4039ms)
  [1m[35m (0.1ms)[0m  rollback transaction
Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5620ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2391ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2651ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5e95b1eb1a86e000001", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:20:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:20:25 UTC, "created_at"=>2013-02-11 10:20:25 UTC}] flags=[] (0.0999ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3619ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5e95b1eb1a86e000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:20:25 UTC, "updated_at"=>2013-02-11 10:20:25 UTC}} flags=[] (0.0918ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3388ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3152ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3850ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5e95b1eb1a86e000002", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:20:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:20:25 UTC, "created_at"=>2013-02-11 10:20:25 UTC}] flags=[] (0.0820ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.4020ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5e95b1eb1a86e000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:20:25 UTC, "updated_at"=>2013-02-11 10:20:25 UTC}} flags=[] (0.0780ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3228ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5e95b1eb1a86e000003", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:20:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:20:25 UTC, "created_at"=>2013-02-11 10:20:25 UTC}] flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2222ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5e95b1eb1a86e000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:20:25 UTC, "updated_at"=>2013-02-11 10:20:25 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3610ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5e95b1eb1a86e000004", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:20:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:20:25 UTC, "created_at"=>2013-02-11 10:20:25 UTC}] flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3328ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5e95b1eb1a86e000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:20:25 UTC, "updated_at"=>2013-02-11 10:20:25 UTC}} flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2701ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3400ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5e95b1eb1a86e000005", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:20:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:20:25 UTC, "created_at"=>2013-02-11 10:20:25 UTC}] flags=[] (0.0830ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3257ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5e95b1eb1a86e000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:20:25 UTC, "updated_at"=>2013-02-11 10:20:25 UTC}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4439ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3960ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5e95b1eb1a86e000006", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:20:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:20:25 UTC, "created_at"=>2013-02-11 10:20:25 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3991ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5e95b1eb1a86e000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:20:25 UTC, "updated_at"=>2013-02-11 10:20:25 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3572ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4528ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5e95b1eb1a86e000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:20:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:20:25 UTC, "created_at"=>2013-02-11 10:20:25 UTC}] flags=[] (0.0777ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3102ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5e95b1eb1a86e000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:20:25 UTC, "updated_at"=>2013-02-11 10:20:25 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3490ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4001ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5e95b1eb1a86e000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:20:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:20:25 UTC, "created_at"=>2013-02-11 10:20:25 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3052ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5e95b1eb1a86e000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:20:25 UTC, "updated_at"=>2013-02-11 10:20:25 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3400ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3979ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c5e95b1eb1a86e000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:20:25 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:20:25 UTC, "created_at"=>2013-02-11 10:20:25 UTC}] flags=[] (0.0882ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2699ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c5e95b1eb1a86e000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:20:25 UTC, "updated_at"=>2013-02-11 10:20:25 UTC}} flags=[] (0.0949ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4489ms)
  [1m[35m (0.0ms)[0m  rollback transaction
Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.6311ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2389ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2561ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c6b55b1eb19438000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:23:49 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:23:49 UTC, "created_at"=>2013-02-11 10:23:49 UTC}] flags=[] (0.0899ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c6b55b1eb19438000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:23:49 UTC}} flags=[] (0.0811ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3490ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c6b55b1eb19438000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:23:49 UTC, "updated_at"=>2013-02-11 10:23:49 UTC}} flags=[] (0.0639ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3409ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3440ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2921ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c6b55b1eb19438000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:23:49 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:23:49 UTC, "created_at"=>2013-02-11 10:23:49 UTC}] flags=[] (0.0782ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c6b55b1eb19438000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:23:49 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.2968ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c6b55b1eb19438000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:23:49 UTC, "updated_at"=>2013-02-11 10:23:49 UTC}} flags=[] (0.0751ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3531ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c6b55b1eb19438000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:23:49 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:23:49 UTC, "created_at"=>2013-02-11 10:23:49 UTC}] flags=[] (0.0720ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c6b55b1eb19438000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:23:49 UTC}} flags=[] (0.0620ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3121ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c6b55b1eb19438000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:23:49 UTC, "updated_at"=>2013-02-11 10:23:49 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3419ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118c6b55b1eb19438000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:23:49 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:23:49 UTC, "created_at"=>2013-02-11 10:23:49 UTC}] flags=[] (0.0830ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c6b55b1eb19438000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:23:49 UTC}} flags=[] (0.0641ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.2313ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c6b55b1eb19438000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:23:49 UTC, "updated_at"=>2013-02-11 10:23:49 UTC}} flags=[] (0.0687ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2370ms)
  [1m[35m (0.0ms)[0m  rollback transaction
Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.7291ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2360ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3130ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.1020ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.1500ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.4451ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2780ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2959ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3560ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0808ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0687ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.4129ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2899ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0703ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0591ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3200ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0851ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4222ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0570ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3529ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0679ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3989ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3278ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3963ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b000005", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0851ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2382ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0770ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3228ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2949ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4251ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b000006", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0849ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.4170ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0732ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3521ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0641ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3388ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3009ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2658ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2871ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3471ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3200ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0811ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4067ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3910ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b00000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0830ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3331ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b00000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0899ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3850ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3951ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b00000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0839ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3309ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b00000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0780ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3781ms)
  [1m[35m (0.0ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3872ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b00000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2439ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b00000c"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.1280ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.6268ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4849ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118cddf5b1eb1c34b00000d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 10:54:23 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 10:54:23 UTC, "created_at"=>2013-02-11 10:54:23 UTC}] flags=[] (0.0889ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3071ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118cddf5b1eb1c34b00000d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 10:54:23 UTC, "updated_at"=>2013-02-11 10:54:23 UTC}} flags=[] (0.0818ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3393ms)
  [1m[35m (0.0ms)[0m  rollback transaction
Connecting to database specified by database.yml
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5519ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2418ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2592ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb15994000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.1149ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0980ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3598ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0758ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3908ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3190ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3059ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb15994000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0811ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0679ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.4201ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3159ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb15994000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0620ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3200ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3641ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb15994000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0708ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0639ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.2940ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.4003ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2911ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3259ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb15994000005", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0808ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3819ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3610ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2129ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2232ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb15994000006", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0751ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3729ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3550ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb15994000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3247ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3769ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb15994000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3409ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0713ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2930ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3521ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb15994000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0758ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3352ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb15994000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3378ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4051ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb1599400000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0780ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3481ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb1599400000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2911ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5331ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb1599400000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.1121ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.4129ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb1599400000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.1001ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4423ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4652ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb1599400000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0844ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3419ms)
an error
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb1599400000c"} update={"$push"=>{"log_messages"=>{"_id"=>"5118e37f5b1eb1599400000d", "kind"=>:error, "message"=>"an error", "date"=>2013-02-11 12:26:39 UTC}}} flags=[] (0.1123ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb1599400000c"} update={"$set"=>{"status"=>:failure, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0629ms)
["/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'", "/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'"]
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb1599400000c"} update={"$push"=>{"log_messages"=>{"_id"=>"5118e37f5b1eb1599400000e", "kind"=>:error, "message"=>"/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'<br/>/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'", "date"=>2013-02-11 12:26:39 UTC}}} flags=[] (0.0799ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb1599400000c"} update={"$set"=>{"finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0598ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3650ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4091ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e37f5b1eb1599400000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:26:39 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:26:39 UTC, "created_at"=>2013-02-11 12:26:39 UTC}] flags=[] (0.0801ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2658ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e37f5b1eb1599400000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:26:39 UTC, "updated_at"=>2013-02-11 12:26:39 UTC}} flags=[] (0.0722ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3781ms)
Connecting to database specified by database.yml
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.6790ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2682ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3140ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e94f5b1eb1c801000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:51:27 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:51:27 UTC, "created_at"=>2013-02-11 12:51:27 UTC}] flags=[] (0.0989ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0901ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3903ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:27 UTC, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0780ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2961ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3130ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3059ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e94f5b1eb1c801000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:51:27 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:51:27 UTC, "created_at"=>2013-02-11 12:51:27 UTC}] flags=[] (0.0839ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3221ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:27 UTC, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2749ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e94f5b1eb1c801000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:51:27 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:51:27 UTC, "created_at"=>2013-02-11 12:51:27 UTC}] flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.1950ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:27 UTC, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0639ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2778ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e94f5b1eb1c801000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:51:27 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:51:27 UTC, "created_at"=>2013-02-11 12:51:27 UTC}] flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0601ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.2768ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:27 UTC, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2978ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3819ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3309ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e94f5b1eb1c801000005", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:51:27 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:51:27 UTC, "created_at"=>2013-02-11 12:51:27 UTC}] flags=[] (0.0877ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3102ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:27 UTC, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0880ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2818ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3839ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3431ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e94f5b1eb1c801000006", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:51:27 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:51:27 UTC, "created_at"=>2013-02-11 12:51:27 UTC}] flags=[] (0.0823ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3290ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4292ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000007"} flags=[:remove_first] (0.0849ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:27 UTC, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0799ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3271ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e94f5b1eb1c801000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:51:27 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:51:27 UTC, "created_at"=>2013-02-11 12:51:27 UTC}] flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3290ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4642ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000008"} flags=[:remove_first] (0.0560ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:27 UTC, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3400ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e94f5b1eb1c801000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:51:27 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:51:27 UTC, "created_at"=>2013-02-11 12:51:27 UTC}] flags=[] (0.0741ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2391ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3810ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000009"} flags=[:remove_first] (0.0463ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:27 UTC, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0648ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3498ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e94f5b1eb1c801000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:51:27 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:51:27 UTC, "created_at"=>2013-02-11 12:51:27 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2210ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4299ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000a"} flags=[:remove_first] (0.0503ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e94f5b1eb1c801000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:27 UTC, "updated_at"=>2013-02-11 12:51:27 UTC}} flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3440ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5159ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9505b1eb1c80100000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:51:28 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:51:28 UTC, "created_at"=>2013-02-11 12:51:28 UTC}] flags=[] (0.1030ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3300ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4311ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000b"} flags=[:remove_first] (0.0629ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9505b1eb1c80100000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:28 UTC, "updated_at"=>2013-02-11 12:51:28 UTC}} flags=[] (0.0839ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4082ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4129ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9505b1eb1c80100000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:51:28 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:51:28 UTC, "created_at"=>2013-02-11 12:51:28 UTC}] flags=[] (0.0889ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.2849ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3991ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000c"} flags=[:remove_first] (0.0720ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9505b1eb1c80100000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:28 UTC, "updated_at"=>2013-02-11 12:51:28 UTC}} flags=[] (0.0799ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3569ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4869ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9505b1eb1c80100000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:51:28 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:51:28 UTC, "created_at"=>2013-02-11 12:51:28 UTC}] flags=[] (0.0958ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3412ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4730ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000d"} flags=[:remove_first] (0.0567ms)
an error
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9505b1eb1c80100000c"} update={"$push"=>{"log_messages"=>{"_id"=>"5118e9505b1eb1c80100000d", "kind"=>:error, "message"=>"an error", "date"=>2013-02-11 12:51:28 UTC}}} flags=[] (0.1149ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9505b1eb1c80100000c"} update={"$set"=>{"status"=>:failure, "updated_at"=>2013-02-11 12:51:28 UTC}} flags=[] (0.0603ms)
["/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'", "/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'"]
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9505b1eb1c80100000c"} update={"$push"=>{"log_messages"=>{"_id"=>"5118e9505b1eb1c80100000e", "kind"=>:error, "message"=>"/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'<br/>/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'", "date"=>2013-02-11 12:51:28 UTC}}} flags=[] (0.0801ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9505b1eb1c80100000c"} update={"$set"=>{"finished_at"=>2013-02-11 12:51:28 UTC, "updated_at"=>2013-02-11 12:51:28 UTC}} flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4108ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3951ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9505b1eb1c80100000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:51:28 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:51:28 UTC, "created_at"=>2013-02-11 12:51:28 UTC}] flags=[] (0.0858ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3309ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4442ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000e"} flags=[:remove_first] (0.0563ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9505b1eb1c80100000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:51:28 UTC, "updated_at"=>2013-02-11 12:51:28 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3939ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5560ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2370ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2561ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a571000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.1092ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0930ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.3719ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2699ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3483ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4261ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a571000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0842ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0780ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.2830ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3629ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a571000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0768ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0589ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.2689ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3068ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a571000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000001", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0589ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000001"}} (0.9542ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2868ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3121ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3021ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a571000005", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3328ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4950ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d00000f"} flags=[:remove_first] (0.0691ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2921ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2942ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3209ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a571000006", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0792ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3269ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4818ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4ad5b1eb1f56d000010"} flags=[:remove_first] (0.0660ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3519ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a571000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3850ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4277ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000005"} flags=[:remove_first] (0.0489ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3011ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a571000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3669ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4301ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000006"} flags=[:remove_first] (0.0491ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0620ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2439ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2658ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a571000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3278ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4051ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000007"} flags=[:remove_first] (0.0570ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a571000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0751ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3638ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4301ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a57100000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.1099ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.4470ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.5500ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000008"} flags=[:remove_first] (0.0932ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a57100000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0832ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3788ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3283ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a57100000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0861ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3059ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3979ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f423000009"} flags=[:remove_first] (0.0560ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a57100000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0770ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4537ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4292ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a57100000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0782ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3383ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4141ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f42300000a"} flags=[:remove_first] (0.0522ms)
an error
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a57100000c"} update={"$push"=>{"log_messages"=>{"_id"=>"5118e9a55b1eb1a57100000d", "kind"=>:error, "message"=>"an error", "date"=>2013-02-11 12:52:53 UTC}}} flags=[] (0.1109ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a57100000c"} update={"$set"=>{"status"=>:failure, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0629ms)
["/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'", "/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'"]
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a57100000c"} update={"$push"=>{"log_messages"=>{"_id"=>"5118e9a55b1eb1a57100000e", "kind"=>:error, "message"=>"/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'<br/>/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'", "date"=>2013-02-11 12:52:53 UTC}}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a57100000c"} update={"$set"=>{"finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0641ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3710ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4139ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9a55b1eb1a57100000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:52:53 UTC, "job_id"=>"5118c4ad5b1eb1f56d000006", "updated_at"=>2013-02-11 12:52:53 UTC, "created_at"=>2013-02-11 12:52:53 UTC}] flags=[] (0.0839ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}} (0.3378ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118c4ad5b1eb1f56d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.4003ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118c4bd5b1eb1f42300000b"} flags=[:remove_first] (0.0567ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9a55b1eb1a57100000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:52:53 UTC, "updated_at"=>2013-02-11 12:52:53 UTC}} flags=[] (0.0732ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3872ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5302ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2933ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2820ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118e9d35b1eb1f39d000001", "delayed"=>true, "_type"=>"Jobbr::TestDelayedJob", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0989ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0951ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0882ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (239.9261ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0980ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3800ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.4218ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4261ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.1230ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0899ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.3707ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0892ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4702ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.1061ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0839ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.3660ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0870ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4179ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000005", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.1009ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000005"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.3579ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0873ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2949ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3388ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2649ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118e9d35b1eb1f39d000006", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.1540ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.1121ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.4060ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.1030ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3848ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3567ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3579ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.1061ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3469ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0911ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4179ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.1011ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3500ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3729ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d00000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2837ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2289ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3340ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d00000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.1001ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3159ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0861ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4239ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3421ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.4790ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4311ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d00000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0987ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2940ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000c"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0839ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3018ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d00000d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3159ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0722ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2320ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.1690ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3409ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d00000e", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0782ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3011ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000e"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0770ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3603ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2871ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2482ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2329ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.1969ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2356ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d00000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0823ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2360ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=4 skip=0 batch_size=nil fields=nil (0.4182ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000007"} flags=[:remove_first] (0.0689ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000008"} flags=[:remove_first] (0.0541ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000009"} flags=[:remove_first] (0.0422ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000a"} flags=[:remove_first] (0.0429ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0830ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2961ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000010", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2880ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2599ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000b"} flags=[:remove_first] (0.0458ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000010"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2582ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000011", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2639ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2189ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000c"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000011"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0641ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2508ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000012", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0668ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2019ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2182ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000d"} flags=[:remove_first] (0.0439ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000012"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0608ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2003ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000013", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0620ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2570ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3529ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000e"} flags=[:remove_first] (0.0479ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000013"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2658ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000014", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2911ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2179ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00000f"} flags=[:remove_first] (0.0472ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000014"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2749ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000015", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2708ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2792ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000010"} flags=[:remove_first] (0.0470ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000015"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3479ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000016", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2282ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2792ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000011"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000016"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2501ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2079ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3698ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000017", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.1020ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3119ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000017"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0839ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3591ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2849ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2999ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4151ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d000018", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0820ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3080ms)
an error
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000018"} update={"$push"=>{"log_messages"=>{"_id"=>"5118e9d35b1eb1f39d000019", "kind"=>:error, "message"=>"an error", "date"=>2013-02-11 12:53:39 UTC}}} flags=[] (0.2053ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000018"} update={"$set"=>{"status"=>:failure, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0751ms)
["/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'", "/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'"]
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000018"} update={"$push"=>{"log_messages"=>{"_id"=>"5118e9d35b1eb1f39d00001a", "kind"=>:error, "message"=>"/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'<br/>/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'", "date"=>2013-02-11 12:53:39 UTC}}} flags=[] (0.0801ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000018"} update={"$set"=>{"finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0620ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3901ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3977ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3598ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3519ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9d35b1eb1f39d00001b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:39 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:39 UTC, "created_at"=>2013-02-11 12:53:39 UTC}] flags=[] (0.0870ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3090ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00001b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:39 UTC, "updated_at"=>2013-02-11 12:53:39 UTC}} flags=[] (0.0792ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3262ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3650ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2933ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.6108ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2451ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2568ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0968ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.1040ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.3841ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0639ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3479ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3943ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3762ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0780ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.3080ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0668ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3190ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0770ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0598ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.3052ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0668ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2730ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0601ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.2909ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3011ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3059ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2692ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000005", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3374ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0708ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3200ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2780ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3409ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000006", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2589ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0789ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.8461ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0780ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3262ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0710ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3090ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3271ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2849ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3378ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3269ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0720ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3901ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3042ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2570ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3321ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f13300000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0877ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2699ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0758ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3231ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f13300000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0951ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3121ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1872ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2849ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3738ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f13300000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0839ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3848ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000c"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3812ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3662ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3531ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2129ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2320ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2761ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f13300000d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0782ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3510ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=12 skip=0 batch_size=nil fields=nil (0.7482ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000012"} flags=[:remove_first] (0.0708ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000013"} flags=[:remove_first] (0.0479ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000014"} flags=[:remove_first] (0.0520ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000015"} flags=[:remove_first] (0.0689ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000016"} flags=[:remove_first] (0.0489ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000017"} flags=[:remove_first] (0.0420ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d000018"} flags=[:remove_first] (0.0470ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9d35b1eb1f39d00001b"} flags=[:remove_first] (0.0639ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000005"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000006"} flags=[:remove_first] (0.0410ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000007"} flags=[:remove_first] (0.0508ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000008"} flags=[:remove_first] (0.0429ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0870ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4249ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f13300000e", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0789ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3231ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2649ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000009"} flags=[:remove_first] (0.0482ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000e"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3183ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f13300000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3130ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2797ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000a"} flags=[:remove_first] (0.0479ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3278ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000010", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3090ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2871ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000b"} flags=[:remove_first] (0.0432ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000010"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2611ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000011", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0668ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3510ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3161ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000c"} flags=[:remove_first] (0.0458ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000011"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0620ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3211ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000012", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0708ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2613ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2229ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000d"} flags=[:remove_first] (0.0463ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000012"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0658ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3510ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000013", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2251ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2680ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000e"} flags=[:remove_first] (0.0482ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000013"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0591ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3090ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000014", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.1070ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2601ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2658ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f13300000f"} flags=[:remove_first] (0.0539ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000014"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0720ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3278ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2928ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4082ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000015", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0820ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3121ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000015"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3490ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.6311ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5879ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5860ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000016", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0858ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3300ms)
an error
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000016"} update={"$push"=>{"log_messages"=>{"_id"=>"5118e9de5b1eb1f133000017", "kind"=>:error, "message"=>"an error", "date"=>2013-02-11 12:53:50 UTC}}} flags=[] (0.1070ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000016"} update={"$set"=>{"status"=>:failure, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0708ms)
["/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'", "/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'"]
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000016"} update={"$push"=>{"log_messages"=>{"_id"=>"5118e9de5b1eb1f133000018", "kind"=>:error, "message"=>"/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'<br/>/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'", "date"=>2013-02-11 12:53:50 UTC}}} flags=[] (0.0782ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000016"} update={"$set"=>{"finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0589ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4539ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3898ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3390ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3519ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118e9de5b1eb1f133000019", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:53:50 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:53:50 UTC, "created_at"=>2013-02-11 12:53:50 UTC}] flags=[] (0.0787ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3171ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000019"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:53:50 UTC, "updated_at"=>2013-02-11 12:53:50 UTC}} flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4010ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3090ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2718ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5960ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2391ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2549ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0980ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0892ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.3259ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3231ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3371ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3841ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0780ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.3090ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3152ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0598ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.3140ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3300ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000001", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0570ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000001"}} (0.2518ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2198ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2880ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3121ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000005", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0751ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2680ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0720ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2701ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2291ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000006", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0770ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2699ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0792ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3662ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0668ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2980ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0708ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2391ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.1199ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2930ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.1059ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3750ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4232ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.1168ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3479ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0920ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3810ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1621ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3641ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4239ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb1264200000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0827ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3121ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0770ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3541ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb1264200000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0668ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3300ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0641ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3431ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2131ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3831ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb1264200000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.1719ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.5121ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000c"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.1097ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5143ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5043ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3810ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1948ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2179ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3090ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb1264200000d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0792ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3150ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=12 skip=0 batch_size=nil fields=nil (0.7520ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000010"} flags=[:remove_first] (0.0732ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000011"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000012"} flags=[:remove_first] (0.0427ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000013"} flags=[:remove_first] (0.0458ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000014"} flags=[:remove_first] (0.0441ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000015"} flags=[:remove_first] (0.0432ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000016"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118e9de5b1eb1f133000019"} flags=[:remove_first] (0.0482ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000005"} flags=[:remove_first] (0.0441ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000006"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000007"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000008"} flags=[:remove_first] (0.0463ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0842ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3948ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb1264200000e", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0939ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2768ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3490ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000009"} flags=[:remove_first] (0.0570ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000e"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.1001ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3631ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb1264200000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3080ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3409ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000a"} flags=[:remove_first] (0.0489ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0620ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3331ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000010", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2601ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.5424ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000b"} flags=[:remove_first] (0.0901ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000010"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0899ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4251ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000011", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0844ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3519ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3560ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000c"} flags=[:remove_first] (0.0770ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000011"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0880ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3190ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000012", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0823ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2909ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3090ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000d"} flags=[:remove_first] (0.0570ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000012"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0699ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3252ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000013", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0708ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3099ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2789ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000e"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000013"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0639ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3982ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000014", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0679ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3068ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3309ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb1264200000f"} flags=[:remove_first] (0.0463ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000014"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0782ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118e9d35b1eb1f39d000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1791ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.2182ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3450ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000015", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0777ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3991ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000015"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0751ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3941ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2418ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2091ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5429ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000016", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.1490ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.4621ms)
an error
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000016"} update={"$push"=>{"log_messages"=>{"_id"=>"5118ea005b1eb12642000017", "kind"=>:error, "message"=>"an error", "date"=>2013-02-11 12:54:24 UTC}}} flags=[] (0.1469ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000016"} update={"$set"=>{"status"=>:failure, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0629ms)
["/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'", "/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'"]
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000016"} update={"$push"=>{"log_messages"=>{"_id"=>"5118ea005b1eb12642000018", "kind"=>:error, "message"=>"/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'<br/>/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'", "date"=>2013-02-11 12:54:24 UTC}}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000016"} update={"$set"=>{"finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0591ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4411ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3998ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3719ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3462ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ea005b1eb12642000019", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:54:24 UTC, "job_id"=>"5118e9d35b1eb1f39d000006", "updated_at"=>2013-02-11 12:54:24 UTC, "created_at"=>2013-02-11 12:54:24 UTC}] flags=[] (0.0801ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118e9d35b1eb1f39d000006"}} (0.3808ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ea005b1eb12642000019"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:54:24 UTC, "updated_at"=>2013-02-11 12:54:24 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3760ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3762ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118e9d35b1eb1f39d000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3309ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (20.4318ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2680ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2990ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118eb395b1eb10a27000001", "delayed"=>true, "_type"=>"Jobbr::TestDelayedJob", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0970ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0980ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0980ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (250.8128ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.1001ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3881ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.4611ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4239ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.1187ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0939ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.3710ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0892ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4492ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.1149ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0827ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.3512ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0887ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4458ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000005", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.1061ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000005"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0801ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.3629ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0939ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3741ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.4079ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4048ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118eb395b1eb10a27000006", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.1421ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.1011ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.4399ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.1118ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3228ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3290ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3221ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0999ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3550ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0911ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4241ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0830ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3219ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3622ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a2700000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3803ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0677ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3221ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2770ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a2700000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.1011ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3111ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0849ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3412ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118eb395b1eb10a27000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2360ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2859ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2871ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a2700000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0861ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2911ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000c"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0892ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3378ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a2700000d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2401ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0699ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118eb395b1eb10a27000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2770ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.1802ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2789ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a2700000e", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2840ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000e"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5419ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4079ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3738ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118eb395b1eb10a27000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2780ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2780ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2701ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a2700000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0808ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3080ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=4 skip=0 batch_size=nil fields=nil (0.4311ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000007"} flags=[:remove_first] (0.0970ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000008"} flags=[:remove_first] (0.0479ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000009"} flags=[:remove_first] (0.0429ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000a"} flags=[:remove_first] (0.0458ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0823ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4117ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000010", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0801ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2971ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2868ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000b"} flags=[:remove_first] (0.0460ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000010"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0679ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3698ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000011", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2639ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2670ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000c"} flags=[:remove_first] (0.0467ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000011"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3822ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000012", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2830ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2270ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000d"} flags=[:remove_first] (0.0482ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000012"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0641ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2551ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000013", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0722ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2661ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2789ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000e"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000013"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0641ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4189ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000014", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0720ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2849ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3183ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700000f"} flags=[:remove_first] (0.0520ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000014"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0668ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2439ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000015", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0691ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2809ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2658ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000010"} flags=[:remove_first] (0.0439ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000015"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2940ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000016", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0679ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3011ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3181ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000011"} flags=[:remove_first] (0.0489ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000016"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0648ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118eb395b1eb10a27000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2282ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2902ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5629ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000017", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0920ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3211ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000017"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0799ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3409ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2720ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2611ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4108ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a27000018", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0811ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2968ms)
an error
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000018"} update={"$push"=>{"log_messages"=>{"_id"=>"5118eb395b1eb10a27000019", "kind"=>:error, "message"=>"an error", "date"=>2013-02-11 12:59:37 UTC}}} flags=[] (0.1078ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000018"} update={"$set"=>{"status"=>:failure, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0629ms)
["/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'", "/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'"]
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000018"} update={"$push"=>{"log_messages"=>{"_id"=>"5118eb395b1eb10a2700001a", "kind"=>:error, "message"=>"/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'<br/>/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'", "date"=>2013-02-11 12:59:37 UTC}}} flags=[] (0.0789ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000018"} update={"$set"=>{"finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4218ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4110ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3610ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3448ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb395b1eb10a2700001b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:37 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:37 UTC, "created_at"=>2013-02-11 12:59:37 UTC}] flags=[] (0.0820ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.4108ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700001b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:37 UTC, "updated_at"=>2013-02-11 12:59:37 UTC}} flags=[] (0.0949ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5441ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3409ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2680ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (20.1137ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2897ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3738ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0970ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0892ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.3841ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0889ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2723ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3600ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2911ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0830ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0770ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.3040ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0741ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3190ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0741ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0639ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.3080ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3603ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0699ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.3548ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0713ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2689ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2971ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3290ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000005", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0932ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2389ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0823ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2220ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2279ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2313ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000006", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0939ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3271ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0722ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3777ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000007", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3581ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000007"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0641ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3638ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0648ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3011ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0808ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2670ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3097ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0691ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3102ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3841ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118eb395b1eb10a27000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2379ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2191ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2172ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f5700000a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2842ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3779ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f5700000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0939ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3431ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118eb395b1eb10a27000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1879ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.1791ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3309ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f5700000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0818ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3521ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000c"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0901ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4320ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3960ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3493ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118eb395b1eb10a27000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2429ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3049ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2811ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f5700000d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0849ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3610ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=12 skip=0 batch_size=nil fields=nil (0.7660ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000012"} flags=[:remove_first] (0.0710ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000013"} flags=[:remove_first] (0.0448ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000014"} flags=[:remove_first] (0.0432ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000015"} flags=[:remove_first] (0.0420ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000016"} flags=[:remove_first] (0.0420ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000017"} flags=[:remove_first] (0.0429ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a27000018"} flags=[:remove_first] (0.0420ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb395b1eb10a2700001b"} flags=[:remove_first] (0.0720ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000005"} flags=[:remove_first] (0.0541ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000006"} flags=[:remove_first] (0.0508ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000007"} flags=[:remove_first] (0.0613ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000008"} flags=[:remove_first] (0.0572ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0980ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4411ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f5700000e", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0772ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3760ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2871ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000009"} flags=[:remove_first] (0.0479ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000e"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0639ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3641ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f5700000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0799ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2370ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2267ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000a"} flags=[:remove_first] (0.0498ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0691ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3641ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000010", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0668ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2539ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2761ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000b"} flags=[:remove_first] (0.0472ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000010"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0699ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3159ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000011", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0710ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3099ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2699ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000c"} flags=[:remove_first] (0.0479ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000011"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3252ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000012", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0658ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3469ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2742ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000d"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000012"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4039ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000013", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0648ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3009ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2720ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000e"} flags=[:remove_first] (0.0451ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000013"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0801ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3541ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000014", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0818ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2511ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2320ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f5700000f"} flags=[:remove_first] (0.0498ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000014"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0722ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118eb395b1eb10a27000006"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1590ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.2120ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3691ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000015", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0799ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3841ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000015"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0808ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3321ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3250ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3409ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5298ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000016", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.1080ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.4051ms)
an error
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000016"} update={"$push"=>{"log_messages"=>{"_id"=>"5118eb405b1eb14f57000017", "kind"=>:error, "message"=>"an error", "date"=>2013-02-11 12:59:44 UTC}}} flags=[] (0.1190ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000016"} update={"$set"=>{"status"=>:failure, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0648ms)
["/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'", "/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'"]
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000016"} update={"$push"=>{"log_messages"=>{"_id"=>"5118eb405b1eb14f57000018", "kind"=>:error, "message"=>"/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'<br/>/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'", "date"=>2013-02-11 12:59:44 UTC}}} flags=[] (0.0801ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000016"} update={"$set"=>{"finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0601ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4370ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3777ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3903ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3858ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eb405b1eb14f57000019", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 12:59:44 UTC, "job_id"=>"5118eb395b1eb10a27000006", "updated_at"=>2013-02-11 12:59:44 UTC, "created_at"=>2013-02-11 12:59:44 UTC}] flags=[] (0.0799ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000006"}} (0.3009ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eb405b1eb14f57000019"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 12:59:44 UTC, "updated_at"=>2013-02-11 12:59:44 UTC}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4151ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3309ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118eb395b1eb10a27000006"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2623ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5808ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2351ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2558ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eca15b1eb1fc11000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:05:37 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 13:05:37 UTC, "created_at"=>2013-02-11 13:05:37 UTC}] flags=[] (0.0951ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eca15b1eb1fc11000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:05:37 UTC}} flags=[] (0.0849ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.3281ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eca15b1eb1fc11000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:05:37 UTC, "updated_at"=>2013-02-11 13:05:37 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3657ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3490ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3371ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eca15b1eb1fc11000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:05:37 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 13:05:37 UTC, "created_at"=>2013-02-11 13:05:37 UTC}] flags=[] (0.0789ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eca15b1eb1fc11000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:05:37 UTC}} flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.3037ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eca15b1eb1fc11000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:05:37 UTC, "updated_at"=>2013-02-11 13:05:37 UTC}} flags=[] (0.0699ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3641ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eca15b1eb1fc11000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:05:37 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 13:05:37 UTC, "created_at"=>2013-02-11 13:05:37 UTC}] flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eca15b1eb1fc11000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:05:37 UTC}} flags=[] (0.0589ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.3269ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eca15b1eb1fc11000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:05:37 UTC, "updated_at"=>2013-02-11 13:05:37 UTC}} flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2742ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118eca15b1eb1fc11000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:05:37 UTC, "job_id"=>"5118eb395b1eb10a27000001", "updated_at"=>2013-02-11 13:05:37 UTC, "created_at"=>2013-02-11 13:05:37 UTC}] flags=[] (0.0620ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eca15b1eb1fc11000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:05:37 UTC}} flags=[] (0.0589ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118eb395b1eb10a27000001"}} (0.2391ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118eca15b1eb1fc11000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:05:37 UTC, "updated_at"=>2013-02-11 13:05:37 UTC}} flags=[] (0.0710ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.7091ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5817ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2501ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1688ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118ecce5b1eb17b45000001", "delayed"=>true, "_type"=>"Jobbr::TestDelayedJob", "updated_at"=>2013-02-11 13:06:22 UTC, "created_at"=>2013-02-11 13:06:22 UTC}] flags=[] (0.0999ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ecce5b1eb17b45000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:06:22 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:06:22 UTC, "created_at"=>2013-02-11 13:06:22 UTC}] flags=[] (0.1099ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ecce5b1eb17b45000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:06:22 UTC}} flags=[] (0.0949ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (244.3621ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ecce5b1eb17b45000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:06:22 UTC, "updated_at"=>2013-02-11 13:06:22 UTC}} flags=[] (0.1011ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3178ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.4621ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4029ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ecce5b1eb17b45000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:06:22 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:06:22 UTC, "created_at"=>2013-02-11 13:06:22 UTC}] flags=[] (0.1190ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ecce5b1eb17b45000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:06:22 UTC}} flags=[] (0.0970ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.3200ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ecce5b1eb17b45000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:06:22 UTC, "updated_at"=>2013-02-11 13:06:22 UTC}} flags=[] (0.0892ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4411ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ecce5b1eb17b45000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:06:22 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:06:22 UTC, "created_at"=>2013-02-11 13:06:22 UTC}] flags=[] (0.1049ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ecce5b1eb17b45000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:06:22 UTC}} flags=[] (0.0780ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.3531ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ecce5b1eb17b45000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:06:22 UTC, "updated_at"=>2013-02-11 13:06:22 UTC}} flags=[] (0.0880ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3839ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ecce5b1eb17b45000005", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:06:22 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:06:22 UTC, "created_at"=>2013-02-11 13:06:22 UTC}] flags=[] (0.1068ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ecce5b1eb17b45000005"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:06:22 UTC}} flags=[] (0.0849ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.3452ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ecce5b1eb17b45000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:06:22 UTC, "updated_at"=>2013-02-11 13:06:22 UTC}} flags=[] (0.0980ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3109ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5448ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2811ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3090ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ed215b1eb12733000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:07:45 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:07:45 UTC, "created_at"=>2013-02-11 13:07:45 UTC}] flags=[] (0.1001ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed215b1eb12733000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:07:45 UTC}} flags=[] (0.0899ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.2968ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed215b1eb12733000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:07:45 UTC, "updated_at"=>2013-02-11 13:07:45 UTC}} flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3169ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3099ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3378ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ed215b1eb12733000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:07:45 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:07:45 UTC, "created_at"=>2013-02-11 13:07:45 UTC}] flags=[] (0.0808ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed215b1eb12733000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:07:45 UTC}} flags=[] (0.0691ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.3018ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed215b1eb12733000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:07:45 UTC, "updated_at"=>2013-02-11 13:07:45 UTC}} flags=[] (0.0691ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3510ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ed215b1eb12733000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:07:45 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:07:45 UTC, "created_at"=>2013-02-11 13:07:45 UTC}] flags=[] (0.0699ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed215b1eb12733000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:07:45 UTC}} flags=[] (0.0603ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.3011ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed215b1eb12733000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:07:45 UTC, "updated_at"=>2013-02-11 13:07:45 UTC}} flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2768ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ed215b1eb12733000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:07:45 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:07:45 UTC, "created_at"=>2013-02-11 13:07:45 UTC}] flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed215b1eb12733000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:07:45 UTC}} flags=[] (0.0598ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.2801ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed215b1eb12733000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:07:45 UTC, "updated_at"=>2013-02-11 13:07:45 UTC}} flags=[] (0.0668ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3200ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.7679ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3371ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.7598ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ed275b1eb15f2c000001", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:07:51 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:07:51 UTC, "created_at"=>2013-02-11 13:07:51 UTC}] flags=[] (0.2081ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed275b1eb15f2c000001"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:07:51 UTC}} flags=[] (0.2072ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.4060ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed275b1eb15f2c000001"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:07:51 UTC, "updated_at"=>2013-02-11 13:07:51 UTC}} flags=[] (0.1140ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.9761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.4959ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4778ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ed275b1eb15f2c000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:07:51 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:07:51 UTC, "created_at"=>2013-02-11 13:07:51 UTC}] flags=[] (0.1652ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed275b1eb15f2c000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:07:51 UTC}} flags=[] (0.0942ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.3490ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed275b1eb15f2c000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:07:51 UTC, "updated_at"=>2013-02-11 13:07:51 UTC}} flags=[] (0.0861ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3488ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ed275b1eb15f2c000003", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:07:51 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:07:51 UTC, "created_at"=>2013-02-11 13:07:51 UTC}] flags=[] (0.0961ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed275b1eb15f2c000003"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:07:51 UTC}} flags=[] (0.0787ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.3071ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed275b1eb15f2c000003"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:07:51 UTC, "updated_at"=>2013-02-11 13:07:51 UTC}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4220ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118ed275b1eb15f2c000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:07:51 UTC, "job_id"=>"5118ecce5b1eb17b45000001", "updated_at"=>2013-02-11 13:07:51 UTC, "created_at"=>2013-02-11 13:07:51 UTC}] flags=[] (0.1421ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed275b1eb15f2c000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:07:51 UTC}} flags=[] (0.1168ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118ecce5b1eb17b45000001"}} (0.3059ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118ed275b1eb15f2c000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:07:51 UTC, "updated_at"=>2013-02-11 13:07:51 UTC}} flags=[] (0.2899ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.6223ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (1.0171ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.4523ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.4900ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3781ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0529ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0398ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.5021ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.5472ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.2470ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0510ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0389ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.5610ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2851ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f0645b1eb12dd7000001", "delayed"=>true, "_type"=>"Jobbr::TestDelayedJob", "updated_at"=>2013-02-11 13:21:40 UTC, "created_at"=>2013-02-11 13:21:40 UTC}] flags=[] (0.1230ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f0645b1eb12dd7000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:21:40 UTC, "job_id"=>"5118f0645b1eb12dd7000001", "updated_at"=>2013-02-11 13:21:40 UTC, "created_at"=>2013-02-11 13:21:40 UTC}] flags=[] (0.0873ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0882ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f0645b1eb12dd7000001"}} (0.3960ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:40 UTC, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0668ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3300ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3059ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0541ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0398ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2809ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2420ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f0645b1eb12dd7000003", "delayed"=>true, "_type"=>"Jobbr::TestDelayedJob", "updated_at"=>2013-02-11 13:21:40 UTC, "created_at"=>2013-02-11 13:21:40 UTC}] flags=[] (0.0987ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f0645b1eb12dd7000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:21:40 UTC, "job_id"=>"5118f0645b1eb12dd7000003", "updated_at"=>2013-02-11 13:21:40 UTC, "created_at"=>2013-02-11 13:21:40 UTC}] flags=[] (0.0732ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0830ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f0645b1eb12dd7000003"}} (0.2921ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:40 UTC, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0598ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3591ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f0645b1eb12dd7000005", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:21:40 UTC, "job_id"=>"5118f0645b1eb12dd7000003", "updated_at"=>2013-02-11 13:21:40 UTC, "created_at"=>2013-02-11 13:21:40 UTC}] flags=[] (0.0620ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000005"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f0645b1eb12dd7000003"}} (0.3901ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:40 UTC, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3059ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f0645b1eb12dd7000006", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:21:40 UTC, "job_id"=>"5118f0645b1eb12dd7000003", "updated_at"=>2013-02-11 13:21:40 UTC, "created_at"=>2013-02-11 13:21:40 UTC}] flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000006"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0591ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f0645b1eb12dd7000003"}} (0.2999ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:40 UTC, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3190ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2570ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::OtherTestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2522ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f0645b1eb12dd7000007", "delayed"=>true, "_type"=>"Jobbr::OtherTestDelayedJob", "updated_at"=>2013-02-11 13:21:40 UTC, "created_at"=>2013-02-11 13:21:40 UTC}] flags=[] (0.1001ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f0645b1eb12dd7000008", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:21:40 UTC, "job_id"=>"5118f0645b1eb12dd7000007", "updated_at"=>2013-02-11 13:21:40 UTC, "created_at"=>2013-02-11 13:21:40 UTC}] flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000008"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0739ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f0645b1eb12dd7000007"}} (0.3519ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:40 UTC, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::OtherTestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4241ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f0645b1eb12dd7000009", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:21:40 UTC, "job_id"=>"5118f0645b1eb12dd7000007", "updated_at"=>2013-02-11 13:21:40 UTC, "created_at"=>2013-02-11 13:21:40 UTC}] flags=[] (0.0687ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000009"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0567ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f0645b1eb12dd7000007"}} (0.3052ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f0645b1eb12dd7000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:40 UTC, "updated_at"=>2013-02-11 13:21:40 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2139ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.2990ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0570ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0420ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (0.6120ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.2530ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0508ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0391ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.5691ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4921ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f06d5b1eb18096000001", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.1090ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000002", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb18096000001", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0849ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb18096000001"}} (0.3529ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0932ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2959ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3872ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0541ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0379ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2737ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2611ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f06d5b1eb18096000003", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0792ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000004", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb18096000003", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb18096000003"}} (0.3021ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3829ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000005", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb18096000003", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb18096000003"}} (0.2589ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4358ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000006", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb18096000003", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0703ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb18096000003"}} (0.3009ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2260ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.1638ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::OtherTestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1950ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f06d5b1eb18096000007", "scheduled"=>true, "_type"=>"Jobbr::OtherTestJob", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0930ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000008", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb18096000007", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0708ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb18096000007"}} (0.3071ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::OtherTestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3181ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000009", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb18096000007", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb18096000007"}} (0.3071ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0677ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2608ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.2980ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0541ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0381ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2129ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f06d5b1eb1809600000a", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb1809600000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000a", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000a"}} (0.3121ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb1809600000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0679ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4261ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118f06d5b1eb1809600000a"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1740ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000a"}} (0.2997ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2639ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb1809600000c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000a", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0720ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000a"}} (0.2971ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb1809600000c"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0732ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3967ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb1809600000d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000a", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0708ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000a"}} (0.3493ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb1809600000d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0679ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118f06d5b1eb1809600000a"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2520ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000a"}} (0.1678ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{}} (0.1271ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.2251ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0482ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0372ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1681ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f06d5b1eb1809600000e", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb1809600000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000e", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0639ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.3130ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb1809600000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0811ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3870ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb1809600000e"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2761ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb1809600000e"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2258ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118f06d5b1eb1809600000e"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2561ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.2329ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2680ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000010", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000e", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0818ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.3331ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000010"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.1421ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4721ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000011", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000e", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0792ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.2499ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000011"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0679ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3631ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000012", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000e", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0677ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.2770ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000012"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2620ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000013", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000e", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0632ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.2749ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000013"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0677ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3030ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000014", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000e", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.3011ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb1809600000e"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3283ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb1809600000f"} flags=[:remove_first] (0.0751ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000014"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3781ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000015", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000e", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0718ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.3080ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb1809600000e"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3362ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000010"} flags=[:remove_first] (0.0470ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000015"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2999ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000016", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000e", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0679ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.2170ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb1809600000e"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2897ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000011"} flags=[:remove_first] (0.0529ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000016"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3569ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000017", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600000e", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0708ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.2942ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb1809600000e"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2749ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000012"} flags=[:remove_first] (0.0987ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000017"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0629ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118f06d5b1eb1809600000e"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2677ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600000e"}} (0.2151ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{}} (0.1249ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118f06d5b1eb1809600000e"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1638ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"job_id"=>"5118f06d5b1eb1809600000e", "_id"=>"5118f06d5b1eb1809600000f"} flags=[] limit=1 skip=0 batch_size=nil fields={:_id=>1} (2.3401ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3750ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0529ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0379ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2198ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f06d5b1eb18096000018", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0908ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb18096000019", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb18096000018", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0670ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb18096000018"}} (0.3171ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb18096000019"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0832ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3409ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb18096000018"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2391ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb18096000018"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2320ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3841ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0563ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0429ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3080ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f06d5b1eb1809600001a", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0882ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb1809600001b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600001a", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600001a"}} (0.3242ms)
an error
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb1809600001b"} update={"$push"=>{"log_messages"=>{"_id"=>"5118f06d5b1eb1809600001c", "kind"=>:error, "message"=>"an error", "date"=>2013-02-11 13:21:49 UTC}}} flags=[] (0.1163ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb1809600001b"} update={"$set"=>{"status"=>:failure, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0660ms)
["/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'", "/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'"]
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb1809600001b"} update={"$push"=>{"log_messages"=>{"_id"=>"5118f06d5b1eb1809600001d", "kind"=>:error, "message"=>"/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'<br/>/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'", "date"=>2013-02-11 13:21:49 UTC}}} flags=[] (0.0782ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb1809600001b"} update={"$set"=>{"finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0603ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4261ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb1809600001a"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3798ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb1809600001a"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3369ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3479ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0558ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0427ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2553ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f06d5b1eb1809600001e", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0868ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f06d5b1eb1809600001f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:21:49 UTC, "job_id"=>"5118f06d5b1eb1809600001e", "updated_at"=>2013-02-11 13:21:49 UTC, "created_at"=>2013-02-11 13:21:49 UTC}] flags=[] (0.0699ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f06d5b1eb1809600001e"}} (0.3660ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f06d5b1eb1809600001f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:21:49 UTC, "updated_at"=>2013-02-11 13:21:49 UTC}} flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4039ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb1809600001e"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2699ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f06d5b1eb1809600001e"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2429ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.4060ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0539ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0520ms)
Connecting to database specified by database.yml
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} (20.5300ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.2980ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0501ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0372ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3650ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2820ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed000001", "delayed"=>true, "_type"=>"Jobbr::TestDelayedJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.1101ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000002", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000001", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0887ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000002"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0877ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000001"}} (0.3951ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000002"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0789ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3490ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3169ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0551ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0398ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2313ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1891ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed000003", "delayed"=>true, "_type"=>"Jobbr::TestDelayedJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0832ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000004", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000003", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0710ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000004"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0751ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000003"}} (0.3018ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000004"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0820ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4210ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000005", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000003", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0930ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000005"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000003"}} (0.2639ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000005"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0770ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::TestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3519ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000006", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000003", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.1578ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000006"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0832ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000003"}} (0.3419ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000006"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0799ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.3319ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2458ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::OtherTestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2880ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed000007", "delayed"=>true, "_type"=>"Jobbr::OtherTestDelayedJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.1092ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000008", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000007", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0720ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000008"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0710ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000007"}} (0.4618ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000008"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"delayed"=>true, "_type"=>"Jobbr::OtherTestDelayedJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3221ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000009", "progress"=>0, "status"=>:waiting, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000007", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000009"} update={"$set"=>{"status"=>:running, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0660ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000007"}} (0.2959ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000009"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"delayed"=>true, "_type"=>{"$ne"=>nil}}} (0.2732ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3569ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0541ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0372ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2289ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1731ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed00000a", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.1023ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00000b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed00000a", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0710ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed00000a"}} (0.3512ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00000b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0772ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3750ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.2451ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0489ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0401ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.1822ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2439ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed00000c", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0889ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00000d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed00000c", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0751ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed00000c"}} (0.2508ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00000d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0708ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3467ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00000e", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed00000c", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed00000c"}} (0.3200ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00000e"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0691ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3338ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00000f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed00000c", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed00000c"}} (0.2990ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00000f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0648ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.3121ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2241ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::OtherTestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1910ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed000010", "scheduled"=>true, "_type"=>"Jobbr::OtherTestJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0942ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000011", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000010", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0823ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000010"}} (0.3829ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000011"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.1161ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::OtherTestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.9351ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000012", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000010", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0722ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000010"}} (0.3581ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000012"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_jobs", :query=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}} (0.2739ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.2980ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0539ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0401ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3672ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed000013", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0710ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000014", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000013", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0620ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000013"}} (0.3033ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000014"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0689ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3262ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118f1525b1eb19eed000013"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1800ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000013"}} (0.2310ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2670ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000015", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000013", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000013"}} (0.2999ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000015"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0789ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3283ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000016", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000013", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000013"}} (0.2778ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000016"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0648ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118f1525b1eb19eed000013"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2921ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000013"}} (0.1659ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{}} (0.1180ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.2520ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0551ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0401ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1948ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed000017", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0720ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000018", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000017", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0672ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.2232ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000018"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0741ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3891ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000017"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2251ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000017"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2000ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118f1525b1eb19eed000017"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1700ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.2232ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2570ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000019", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000017", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.3021ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000019"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3691ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00001a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000017", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0701ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.2859ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00001a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4213ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00001b", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000017", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0682ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.3130ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00001b"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0648ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3901ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00001c", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000017", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.2971ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00001c"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0691ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2711ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00001d", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000017", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0646ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.2940ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000017"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2491ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000018"} flags=[:remove_first] (0.0732ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00001d"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3791ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00001e", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000017", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0870ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.3099ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000017"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.3262ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000019"} flags=[:remove_first] (0.0551ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00001e"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3610ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00001f", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000017", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0730ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.2997ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000017"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2651ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00001a"} flags=[:remove_first] (0.0482ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00001f"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0651ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2990ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000020", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000017", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0648ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.2942ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000017"}, "$orderby"=>{"started_at"=>1}} flags=[] limit=1 skip=0 batch_size=nil fields=nil (0.2818ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00001b"} flags=[:remove_first] (0.0529ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000020"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0677ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118f1525b1eb19eed000017"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1750ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000017"}} (0.2410ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{}} (0.1659ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={:_id=>"5118f1525b1eb19eed000017"} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.1938ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"job_id"=>"5118f1525b1eb19eed000017", "_id"=>"5118f1525b1eb19eed000018"} flags=[] limit=1 skip=0 batch_size=nil fields={:_id=>1} (0.3831ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3290ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0541ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0367ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2391ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed000021", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0832ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000022", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000021", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0792ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000021"}} (0.3312ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000022"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0987ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3912ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000021"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2391ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000021"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2570ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.4230ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0520ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0370ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3140ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed000023", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0882ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000024", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000023", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0699ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000023"}} (0.2408ms)
an error
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000024"} update={"$push"=>{"log_messages"=>{"_id"=>"5118f1525b1eb19eed000025", "kind"=>:error, "message"=>"an error", "date"=>2013-02-11 13:25:38 UTC}}} flags=[] (0.1130ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000024"} update={"$set"=>{"status"=>:failure, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0579ms)
["/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'", "/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'", "/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'", "/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'"]
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000024"} update={"$push"=>{"log_messages"=>{"_id"=>"5118f1525b1eb19eed000026", "kind"=>:error, "message"=>"/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/exception_raiser.rb:12:in `evaluate'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/return_values.rb:20:in `next'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/expectation.rb:445:in `invoke'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/mock.rb:157:in `method_missing'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/mocha-0.9.12/lib/mocha/any_instance_method.rb:34:in `perform'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:57:in `run'<br/>/Users/cblavier/code/jobbr/app/models/jobbr/job.rb:26:in `run'<br/>/Users/cblavier/code/jobbr/spec/models/scheduled_job_spec.rb:64:in `block (2 levels) in <module:Jobbr>'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `instance_eval'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:114:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:254:in `with_around_each_hooks'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example.rb:111:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:388:in `block in run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:384:in `run_examples'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/example_group.rb:369:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `map'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:28:in `block in run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/reporter.rb:34:in `report'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/command_line.rb:25:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:80:in `run'<br/>/Users/cblavier/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/rspec-core-2.12.2/lib/rspec/core/runner.rb:17:in `block in autorun'", "date"=>2013-02-11 13:25:38 UTC}}} flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000024"} update={"$set"=>{"finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0551ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4742ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000023"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.5231ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000023"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3581ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3169ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0498ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0381ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::TestJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2949ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed000027", "scheduled"=>true, "_type"=>"Jobbr::TestJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0761ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed000028", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000027", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.1333ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000027"}} (0.4270ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed000028"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.1402ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4077ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000027"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3819ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000027"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3657ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.4671ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0572ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0389ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>"Jobbr::LoggingJob"}, "$orderby"=>{:_id=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.2980ms)
WARNING: Can't mass-assign protected attributes: _type
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_jobs documents=[{"_id"=>"5118f1525b1eb19eed000029", "scheduled"=>true, "_type"=>"Jobbr::LoggingJob", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0970ms)
  MOPED: 127.0.0.1:27017 INSERT       database=dummy_test collection=jobbr_runs documents=[{"_id"=>"5118f1525b1eb19eed00002a", "progress"=>0, "status"=>:running, "started_at"=>2013-02-11 13:25:38 UTC, "job_id"=>"5118f1525b1eb19eed000029", "updated_at"=>2013-02-11 13:25:38 UTC, "created_at"=>2013-02-11 13:25:38 UTC}] flags=[] (0.0677ms)
  MOPED: 127.0.0.1:27017 COMMAND      database=dummy_test command={:count=>"jobbr_runs", :query=>{"job_id"=>"5118f1525b1eb19eed000029"}} (0.3209ms)
foo
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00002a"} update={"$push"=>{"log_messages"=>{"_id"=>"5118f1525b1eb19eed00002b", "kind"=>:debug, "message"=>"foo", "date"=>2013-02-11 13:25:38 UTC}}} flags=[] (0.1111ms)
bar
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00002a"} update={"$push"=>{"log_messages"=>{"_id"=>"5118f1525b1eb19eed00002c", "kind"=>:error, "message"=>"bar", "date"=>2013-02-11 13:25:38 UTC}}} flags=[] (0.0849ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=dummy_test collection=jobbr_runs selector={"_id"=>"5118f1525b1eb19eed00002a"} update={"$set"=>{"status"=>:success, "finished_at"=>2013-02-11 13:25:38 UTC, "updated_at"=>2013-02-11 13:25:38 UTC}} flags=[] (0.0749ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_jobs selector={"$query"=>{"scheduled"=>true, "_type"=>{"$ne"=>nil}}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3688ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000029"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.4451ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=jobbr_runs selector={"$query"=>{"job_id"=>"5118f1525b1eb19eed000029"}, "$orderby"=>{:_id=>-1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil (0.3021ms)
  MOPED: 127.0.0.1:27017 QUERY        database=dummy_test collection=system.namespaces selector={:name=>{"$not"=>/system|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil (0.3090ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_jobs selector={} flags=[] (0.0548ms)
  MOPED: 127.0.0.1:27017 DELETE       database=dummy_test collection=jobbr_runs selector={} flags=[] (0.0410ms)
